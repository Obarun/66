<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="Content-Language" content="en" />
    <title>The 66 Suite: 66-hpr</title>
    <meta name="Description" content="Detailed documentation for the 66-shutdownd command which is part of the 66 software suite" />
    <meta name="Keywords" content="66 command 66-hpr service supervision supervise handles system shutdown reboot poweroff halt" />
    <!-- <link rel="stylesheet" type="text/css" href="//skarnet.org/default.css" /> -->
  </head>
<body>

<p>
<a href="index.html">66</a><br />
<a href="//obarun.org/">www.obarun.org</a>
</p>

<h1> 66-hpr</h1>

	<p>
		<tt>66-hpr</tt> triggers the software shutdown procedure,
		or, with the <tt>-f</tt> option, it perform an immediate hardware shutdown.
		It is normally invoked through <tt>halt</tt>, <tt>poweroff</tt> or
		<tt>reboot</tt> wrappers installed by default at <em>/etc/66</em>. 
		This program is a modified copy of <a href="https://skarnet.org/software/s6-linux-init/s6-linux-init-hpr.html">s6-linux-init-hpr</a> program.
	</p>

<h2> Interface </h2>

	<pre>
		 s6-linux-init-hpr [ -H ] [ -l live ] [ -b banner ] [ -f ] [ -h | -p | -r ] [ -d | -w ] [ -W ]
	</pre>

	<ul>
		 <li> If the <tt>-f</tt> option is present, the system is stopped or rebooted immediately. </li>
		 <li> Else, the machine's shutdown procedure is started.
		 <li> The command exits 0; the shutdown procedure happens asynchronously. </li>
	</ul>

	<p>
		This interface is the traditional <em>sysvinit</em> interface for the
		<tt>halt</tt>, <tt>poweroff</tt> and <tt>reboot</tt> programs.
		<tt>66-hpr</tt> must always be called with one of the
		<tt>-h</tt>, <tt>-p</tt> or <tt>-r</tt> options.
	</p>

<h2> Options </h2>

	<ul>
		<li>
			 <tt>-H&nbsp;</tt>&nbsp;: prints this help.
		</li>
		<li>
			<tt>-l&nbsp;<em>live</em></tt>&nbsp;: <em>live</em> directory to use. <tt>66-hpr</tt> sends signal the pipe of the <a href="66-shutdownd.html">66-shutdownd</a> service at <tt><em>live</em>/scandir/0/shutdownd/fifo</tt>. Default is
			<tt>/run/66</tt>. The default can also be changed at compile-time by
			passing the <tt>--livedir=<em>live</em></tt> option to <tt>./configure</tt>. 
			An absolute path is expected and should be under a writable filesystem 
			- likely a RAM filesystem.
		</li>
		<li>
			 <tt>-b&nbsp;</tt>&nbsp;: banner to display before execs the shut down process. Default:
<pre>*** WARNING *** 
The system is going down NOW!</pre>
		</li>
		 <li> <tt>-f</tt>&nbsp;: force. The command will not trigger a clean shutdown
		procedure; it will just sync the filesystems then tell the kernel to immediately
		halt, poweroff or reboot. This should be the last step in the lifetime of the
		machine. </li>
		 <li> <tt>-h</tt>&nbsp;: halt. The system will be shut down, but the power will remain up. </li>
		 <li> <tt>-p</tt>&nbsp;: poweroff. The system will be shut down and the power turned off. </li>
		 <li> <tt>-r</tt>&nbsp;: reboot. The system will reboot. </li>
		 <li> <tt>-d</tt>&nbsp;: Do not write a wtmp shutdown entry. </li>
		 <li> <tt>-w</tt>&nbsp;: Only write a wtmp shutdown entry; do not actually shut down
		the system. </li>
		 <li> <tt>-W</tt>&nbsp;: Do not send a <tt>wall</tt> message to users before shutting
		down the system. Some other implementations of the <tt>halt</tt>, <tt>poweroff</tt>
		and <tt>reboot</tt> commands use the <tt>--no-wall</tt> long option to achieve this. </li>
	</ul>

<h2> Notes </h2>

	<ul>
		<li> <tt>halt</tt>, <tt>poweroff</tt> and <tt>reboot</tt> scripts that call <tt>66-hpr</tt>
		with the relevant option <strong>should be copied or symlinked</strong> by the administrator into the binary directory of your system.</li>
	</ul>
</body>
</html>
