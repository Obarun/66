<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<meta name="date" content="2020-05-08" scheme="YYYY-MM-DD" />
<meta name="author" content="Eric Vidal &lt;eric@obarun.org&gt;" />
<title>The 66 Suite: 66-intree</title>
</head>
<body>

<p><a href="index.html">66</a></p>

<p><a href="https://web.obarun.org">obarun.org</a></p>

<h1 id="66-intree">66-intree</h1>

<p>This command displays information about trees.</p>

<h2 id="Interface">Interface</h2>

<pre><code>    66-intree [ -h ] [ -z ] [ -v verbosity ] [ -l live ] [ -n ] [ -o name,init,enabled,... ] [ -g ] [ -d depth ] [ -r ] tree
</code></pre>

<h2 id="Exit%20codes">Exit codes</h2>

<ul>
<li><em>0</em> success</li>
<li><em>100</em> wrong usage</li>
<li><em>111</em> system call failed</li>
</ul>

<h2 id="Options">Options</h2>

<ul>
<li><p><strong>-h</strong> : prints this help.</p></li>
<li><p><strong>-z</strong> : use color.</p></li>
<li><p><strong>-v</strong> <em>verbosity</em> : increases/decreases the verbosity of the command.</p>

<ul>
<li><em>1</em> : only print error messages. This is the default.</li>
<li><em>2</em> : also print warning messages.</li>
<li><em>3</em> : also print tracing messages.</li>
<li><em>4</em> : also print debugging messages.</li>
</ul></li>
<li><p><strong>-l</strong> <em>live</em> : changes the supervision directory of <em>service</em> to <em>live</em>. By default this will be <code>%%livedir%%</code>. The default can also be changed at compile time by passing the <code>--livedir=live</code> option to <code>./configure</code>. An existing absolute path is expected and should be within a writable filesystem - likely a RAM filesystem—see <a href="66-scandir.html">66-scandir</a>.</p></li>
<li><p><strong>-n</strong> : do not display the field name(s) specified.</p></li>
<li><p><strong>-o</strong> : comma separated list of fields to display. If this option is not passed, <em>66-intree</em> will display all fields.</p></li>
<li><p><strong>-g</strong> : shows the dependency list of the <em>service</em> as a hierarchical graph instead of a list.</p></li>
<li><p><strong>-d</strong> <em>depth</em> : limits the depth of the dependency list visualisation; default is 1. This implies <strong>-g</strong> option. </p></li>
<li><p><strong>-r</strong> : shows the dependency list of <em>tree</em> in reverse mode.</p></li>
</ul>

<p><strong><em>(!)</em></strong> If tree is not specified <em>66-intree</em> will display information about all available trees for the current owner of the process.</p>

<h2 id="Valid%20fields%20for%20-o%20options">Valid fields for -o options</h2>

<ul>
<li><em>name</em> : displays the name of the <em>tree</em>.</li>
<li><em>init</em> : displays a boolean value of the initialization state.</li>
<li><em>enabled</em> : displays a boolean value of the enable state.</li>
<li><em>start</em> : displays the list of <em>tree</em>(s) started before.</li>
<li><em>current</em> : displays a boolean value of the current state.</li>
<li><em>allowed</em> : displays the list of allowed user to use the <em>tree</em>.</li>
<li><em>symlinks</em> : displays the target of <em>tree</em>&#8217;s symlinks.</li>
<li><em>contents</em> : displays the contents of the <em>tree</em>.</li>
</ul>

<h2 id="Command%20and%20output%20examples">Command and output examples</h2>

<p>The command <code>66-intree boot</code>, run as root user, on <a href="https://web.obarun.org">Obarun</a>&#8217;s default system displays the following where <em>boot</em> is the tree used to properly boot the machine:</p>

<pre><code>    Name         : boot
    Initialized  : yes
    Enabled      : no
    Starts after : None
    Current      : no
    Allowed      : root
    Symlinks     : svc-&gt;source db-&gt;source
    Contents     : tty12  system-hostname  mount-run  populate-run  mount-tmp  populate-tmp  mount-proc  mount-sys
                   populate-sys  mount-dev  mount-pts  mount-shm  populate-dev  mount-cgroups  00  modules-kernel  udevd
                   udevadm  devices-crypttab  system-hwclock  system-random  modules-system  system-sysctl
                   system-fontnkey  devices-dmraid  devices-btrfs  devices-lvm  devices-zfs  system-Devices  mount-swap
                   all-Mount  system-fsck  mount-fstab  all-System  mount-rw  local-iptables  local-ip6tables  local-loop
                   local-sethostname  local-time  local-authfiles  local-tmpfiles  local-rc  local-dmesg  all-Local
                   all-Runtime  All
</code></pre>

<p>The field <em>name</em> gives you the name of the tree.</p>

<p>The field <em>Initialized</em> tells you if the tree was initialized with <a href="66-init.html">66-init</a> tool.</p>

<p>The field <em>Enabled</em> reveals the state of the tree—see <a href="66-tree.html">66-tree -E</a>.</p>

<p>The field <em>Starts after</em> reveals the start process order if the <em>tree</em> is enabled, meaning which <em>tree</em> is started before the current one.</p>

<p>The field <em>Current</em> tells you if the tree is the current one or not—see <a href="66-tree.html">66-tree -c</a>.</p>

<p>The field <em>Allowed</em> gives you a list of user(s) allowed to handle the tree—see <a href="66-tree.html">66-tree -a|b</a>.</p>

<p>The field <em>Symlinks</em> tells you if the current live state point to the <em>source</em> or the <em>backup</em> of the <em>tree</em>. Every use of <a href="66-enable.html">66-enable</a> tool create a automatic backup of the tree for <code>classic</code>,<code>bundle</code> or <code>atomic</code> service(s). A symlink pointing to <em>backup</em> mean that you have enabled a service without starting it. Right after a boot, each tree should point to <em>source</em>.</p>

<p>The field <em>Contents</em> gives you a list of all services enabled in the <em>tree</em>.</p>

<p>You can display the contents list as a graph and only these fields using the command <code>66-intree -o contents -g boot</code>: </p>

<pre><code>    Contents    : /
                  ├─(253,Enabled,classic) tty12
                  ├─(0,Enabled,oneshot) system-hostname
                  ├─(0,Enabled,oneshot) mount-run
                  ├─(0,Enabled,oneshot) populate-run
                  ├─(0,Enabled,oneshot) mount-tmp
                  ├─(0,Enabled,oneshot) populate-tmp
                  ├─(0,Enabled,oneshot) mount-proc
                  ├─(0,Enabled,oneshot) mount-sys
                  ├─(0,Enabled,oneshot) populate-sys
                  ├─(0,Enabled,oneshot) mount-dev
                  ├─(0,Enabled,oneshot) mount-pts
                  ├─(0,Enabled,oneshot) mount-shm
                  ├─(0,Enabled,oneshot) populate-dev
                  ├─(0,Enabled,oneshot) mount-cgroups
                  ├─(0,Enabled,bundle) 00
                  ├─(0,Enabled,oneshot) modules-kernel
                  ├─(485,Enabled,longrun) udevd
                  ├─(0,Enabled,oneshot) udevadm
                  ├─(0,Enabled,oneshot) devices-crypttab
                  ├─(0,Enabled,oneshot) system-hwclock
                  ├─(0,Enabled,oneshot) system-random
                  ├─(0,Enabled,oneshot) modules-system
                  ├─(0,Enabled,oneshot) system-sysctl
                  ├─(0,Enabled,oneshot) system-fontnkey
                  ├─(0,Enabled,oneshot) devices-dmraid
                  ├─(0,Enabled,oneshot) devices-btrfs
                  ├─(0,Enabled,oneshot) devices-lvm 
                  ├─(0,Enabled,oneshot) devices-zfs
                  ├─(0,Enabled,bundle) system-Devices
                  ├─(0,Enabled,oneshot) mount-swap 
                  ├─(0,Enabled,bundle) all-Mount
                  ├─(0,Enabled,oneshot) system-fsck
                  ├─(0,Enabled,oneshot) mount-fstab
                  ├─(0,Enabled,bundle) all-System
                  ├─(0,Enabled,oneshot) mount-rw
                  ├─(0,Enabled,oneshot) local-iptables
                  ├─(0,Enabled,oneshot) local-ip6tables
                  ├─(0,Enabled,oneshot) local-loop
                  ├─(0,Enabled,oneshot) local-sethostname
                  ├─(0,Enabled,oneshot) local-time
                  ├─(0,Enabled,oneshot) local-authfiles
                  ├─(0,Enabled,oneshot) local-tmpfiles  
                  ├─(0,Enabled,oneshot) local-rc
                  ├─(0,Enabled,oneshot) local-dmesg
                  ├─(0,Enabled,bundle) all-Local
                  ├─(0,Enabled,oneshot) all-Runtime
                  └─(0,Enabled,bundle) All
</code></pre>

<p>For each service the first field found between <code>()</code> parentheses is the corresponding pid of the service, the second one is the state of the service, and next to it is the type of the service, separated by commas, and finally the name of the service is displayed after the parenthesis <code>)</code>.</p>

<p>By default the dependency graph is rendered in the order of execution. In this example the <code>classic</code> <em>tty12</em> is the first executed service and <code>bundle</code> <em>All</em> is the last before it finishes. You can reverse the rendered order with the <strong>-r</strong> option.</p>

<p>You can display the name and current field and only these fields for each tree using the command <code>66-intree -o name,current</code>:</p>

<pre><code>    Name        : boot
    Current     : no

    Name        : docker
    Current     : no

    Name        : root
    Current     : no

    Name        : test
    Current     : yes

    Name        : user
    Current     : no
</code></pre>
</body>
</html>
